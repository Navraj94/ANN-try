function [Y,Xf,Af] = rosseler_ann(X,~,~)
%ROSSELER_ANN neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 31-May-2020 15:41:10.
% 
% [Y] = rosseler_ann(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-19.5002001900734;-21.1486530069743;0.000521988184648547];
x1_step1.gain = [0.0480105776098154;0.0510005931307965;0.0550388963569397];
x1_step1.ymin = -1;

% Layer 1
b1 = [8.6300666614723891001;6.9608265746108441974;4.8922039933764951414;-4.6896839608891571771;-3.9854107758384711424;-5.2367433094378661451;-3.4932570804990490387;2.6080941222283846592;-1.5515190241527387904;-0.091080098109028173603;1.5128060799626095179;2.341396737059775468;3.2242106264502647939;2.5518898631927755538;-3.960271681455501902;4.7947754456183728777;4.6810770842092512822;6.1927426978080344355;5.1055408684081591275;-5.8023081358425301346];
IW1_1 = [-3.4513411684290513648 4.958278781336224128 -3.7220546175902446961;-3.6004939751285114369 -0.21721293866883500945 4.9297315222570627924;-1.9834463601008693878 -4.3199191841758199928 -0.32466541154889694276;3.7101791266230530475 4.699035470491987887 3.7454779123084698256;0.60845748928452658699 4.7053143035496018953 4.8411692928010197079;9.8068350513315696304 1.7425614541293026338 4.5367548387424010414;7.3811367438171995303 1.9378331862717161904 4.3999979228198231596;-3.752223307330908586 3.6326653830839501502 -0.075917883083241891051;2.890468397670786338 0.012746460695804116836 -2.4232157024688718572;3.776535812618226462 1.5538926296781665481 -4.4901367420083193593;-6.8107281440355826874 -0.78541748074793282797 -4.1222802124548065805;5.4554303246582760423 -1.3439478765012604633 -4.3457133348257821481;1.286472751326765529 1.7760486554840750895 4.4398830284996977369;4.1269336236827784958 1.9020876649841442774 4.0242570179543726283;-0.62497759720081325074 -5.3463633579972649201 3.8462952293045025165;5.002870453356675462 3.1790464895849286364 -3.0894189190512069132;1.600298625311522116 2.6271109649074091408 2.8211697856450399513;4.9775734639939805959 -3.4884994249971805758 -4.1866490553566810817;2.1920991118911916651 -1.4483298043322609949 3.4470761810327763541;-3.4550153546569921659 0.96711022004524660467 -6.1270315887820192557];

% Layer 2
b2 = [-0.36523757103942927627;1.1964403687970912582;-3.4279885249472710207;-0.92414321019396927781;1.549494079683836345;1.0628040867985235618;-2.474181359392356061;-0.61045784324460206083;2.9051520740514615859;-1.3357007796678597167;-3.5413721699432865186;-3.4602635677889472809;1.1593100980539934319;-2.1903898544911020174;-1.8257557258621748275;-0.84119102983916127503;-4.8845259578167974368;-1.7137253528954556892;-0.78331824668007810075;1.7457936662442548048];
LW2_1 = [-2.1999208255863913486 1.7013278536238043426 -1.0914924098888343362 -0.25344160839869389612 0.74585879827904222328 -1.4022848494198663083 3.0199547784058098365 2.1613359155683569135 1.1018971139622615318 0.73587691577581548774 0.72668682591403443993 0.24860257503865440531 0.61558905327457347223 -1.2481250912217034532 -0.21062286959199230663 -0.6592770849764637564 -0.63137196271112527857 -1.0597683885127950898 0.86893540733929008901 0.10692956848930972036;-1.8175067024184077269 -0.41026034152146384493 1.1458739132657123072 0.91160966914746754952 -0.30739949462608306963 1.7396470514458799439 0.75091629852439401027 -1.1470456785198104299 0.15841822810613639949 0.67945323539758761822 1.2346460777056622593 -0.17950825079191973233 -0.85495581582682034227 -0.41967716766221374591 0.64251470863698523228 -0.89529117422302517681 0.60048674195063178605 -0.0063083431207718978009 -0.94652464773191513636 0.62263572783706133684;0.62554266020831306161 -0.074189055738431694542 0.60094752357110914343 -0.081721944432204193798 -0.059924242010907728673 0.65894373362618385848 -0.30500257526565177635 -0.15072605823942961112 -0.2558207927222788669 -0.53282538413226299134 0.30845482211386082705 0.3373714575675584304 -0.41256222417740262554 0.0049099694786951366202 0.99566073825239076456 1.1282838260347296533 -0.0049890054227592992714 0.38621057882102727277 0.72006900867721468362 0.027454716273240677149;0.70546051328300074523 0.088579537970518970602 -0.86473190792022158746 -1.173603825289846414 0.70648369333030769379 -0.24522732394440202586 1.427631340439806662 -0.6295000657117115761 -0.80356137467392430018 -0.51154568654778220793 0.14105674099966239443 -0.46741643539587007794 0.057063724278266253487 0.39958449363343806482 0.58115839523185530702 0.69282142902276711016 0.2747410163766761948 -0.34072344348819372239 -0.22128374043576606867 1.1813280871830922347;0.010025439468028137652 -0.33732918993096655536 -0.64250421473978780451 -1.3340405068193108562 -0.17088676719679962712 -0.082414731394527582231 -0.084025708658086617486 -0.058949316540225248084 0.10702884793837523503 -0.40341289205538216622 -0.041029529683732308964 -0.46205965672520871168 -2.0371814646753878542 -0.12256496734274544003 0.7834840932915494438 -0.23266917853727439591 -0.47064020005888085318 -0.51375422682388693918 0.70159649541089719182 -0.31145245411231853305;-0.76818169625623655694 -0.48260987771975233374 -1.9322759878675186407 1.1930673885848990246 -0.3077257423548985793 0.053869766634939135475 1.6875483161811908328 -1.2525805653210402291 1.23548886238984168 0.19937481416654975752 -1.3960214505739321211 0.82474217000842342529 0.10384317961915241757 1.1377932638637262563 -0.54892037682804295518 -1.1066708914386391704 0.75970741011884268534 -0.15140312381363829619 1.3920191087993083467 -0.081244388541766909828;0.58882760497369301955 1.0151299039884311703 0.067718041051009758569 0.38325133819599238594 1.1001111192342793998 1.8073175193261410421 -0.88392740894000954022 0.030438476785538206432 -0.5666837222303292565 0.29962511462447960486 1.7378043646095702179 -0.48470921582776638203 -0.63305077769586548531 0.82093373827958104894 1.0251840553099855757 -0.0069170707258324201985 -0.093645728750513954064 0.92620508636946863312 -1.9141471424279365987 0.41134640931977528577;-1.5176658703335477174 0.92669164408225723761 0.9110604955006248451 1.5125231820439080099 0.51693732075089560141 -3.2364449705147060321 1.7483709706908625581 -0.095262424857215019514 0.49189114465817174171 0.11159823892138388823 -0.43892203210958269377 0.075696837363502869622 -1.5860887735572581914 0.69618064592927098033 -0.16372802479443018808 0.31819341836429326786 -0.050485879102161797249 -0.0053035168657900927033 0.2811668126106473542 -0.074569973929920901901;1.5957131285989409886 0.37568562140666389437 -0.92309161741922129973 0.4647973543839652999 -0.74878215829101379963 0.26724164630188351754 -1.7508396047711811683 -0.20968274050830293387 -0.52993146171556859692 0.27698164701874522509 -0.47823254801077980103 -0.43304115997114872583 -0.98905405772705035083 0.8046030926626158708 0.43039012470900117613 -1.0539252933513059141 -0.18417657020552383185 -0.28370667293894724637 -0.5227347075722506009 -0.33717102452843394911;-0.062094543946039443272 0.091436276500030236325 -1.7568039989671691004 0.57690621481948056726 0.55201327433715163817 -1.1077490499871018859 2.1952353702788274248 -0.71562269460220984119 -1.4828846452477402185 -1.0420866913532289555 -0.63182506081378531082 -0.60049723216088013444 2.2941623533676507307 1.3163327897798069444 -0.18717224327258807914 -0.16805694960950018357 0.51052122652540710135 -0.93517248918313755635 1.1061169277049718307 -1.9365247928821704981;0.55062824987845104818 -0.22775576027519478517 1.0396546446910550632 -0.32356423105339993107 0.062025244184782106494 0.64419941709877936997 0.70570792575199836616 1.4474974938091851318 1.8892078132985872241 1.0723503166200565317 -0.79948344977044694115 0.90271889537225147304 0.59005873042082035429 -0.28585503215454188819 -0.014180127317102962647 1.2673935810132062052 -1.1861009982830870157 -0.75602965411057032608 0.11267608432489525927 -0.2863768976654557652;0.32390543559812778884 -0.59325740266921989097 -0.072746156556247595915 0.61785081394159524493 0.8030646741482931894 1.0599423627844073437 0.6001025924610677853 -0.031343819846654782935 -0.18409247045940754783 0.2664922213436193843 1.4769249295644530928 0.58349784093883538816 0.29113364894602078436 -0.27748675777693876388 0.58724760466669412295 1.036645424012173633 0.56071426541642543917 1.2311991442732972413 -0.26220729979673018661 0.6395394055958439905;0.97559615611031558213 0.80564389955583226577 1.1401298196094498127 1.216665227397133231 0.43830690223188534249 -3.859517350688069115 2.9830536223042325439 0.10272128883638857733 0.52675967868744466571 0.52094920234125774439 -0.29116525539560761393 -0.36445083458369159635 -0.28773449902330527905 -0.20455646727062862245 0.06667603195685324613 -1.731874096624005821 -0.87589201193934196343 0.53026443683721191658 -1.3094689412883078194 0.17714377188159699528;0.78063771905601597734 -0.60385133915800459636 -0.063525919364541105772 -0.13736033040754119794 0.83488120739239690682 0.80406999210261476119 0.30617593952494781551 0.14948659043624862308 0.36146417899116289885 0.050636696469253332509 0.38769271731507359835 -0.19528852535115753808 0.40457121850362132154 -0.18721872628932023641 0.025083402185892292313 0.86084304634419017699 0.21663439783123747406 0.90189463470565800485 0.31210250106595471831 0.15619335779936829867;-1.1621794364659223664 -0.31359837331336593014 -0.84586740857299991259 0.81608132975450664581 1.0733884292419870743 2.4950597175039397335 -3.3121745891852660826 0.55543767825649847936 1.1718935990517682644 0.79618467424147931766 -0.34324290848264304987 0.90978294543790294568 1.4375711639382813267 0.10751726895436761189 0.46689567711412183204 0.36584536314444093819 1.1191504528965030563 -0.75686638138315009972 -1.0591531997082557215 0.93733171031209105983;-0.65033760182822142326 -0.68025891283914730057 -0.14740739590644685864 0.048243410603028648309 1.1139206973432875802 -2.579436823124008793 1.8991977354939122424 -1.6503703505126183781 0.12763576867885367827 0.39504633700567720611 -0.18426239920453280074 -0.36477625776408417746 0.1579420856257385819 -1.3757411991481163227 0.84737036449235392244 0.061279827523462289396 0.65819247644477263393 0.77534228571052732359 -1.0659929340770888384 -1.1133835071064954736;-0.6586283282881595369 0.20257006613209352364 -0.74568719966773799879 -1.3148926160189677859 0.85669333524292134996 0.25560059580332994411 -1.0989763767803977235 1.1700934608758823963 0.76034031918155364771 0.44372473219911801046 0.96101975522927163276 0.92894869773257149337 1.3958221113765552079 1.0366125304391862194 0.84518282944938016854 0.64007485691950782858 -0.12564196504190691672 0.66475372045871661264 -0.5628020047477105825 1.1491468512954003955;-1.1091226571234220621 -0.22030157293644417327 -0.53253121671369330059 0.36157596403015679343 -0.34421415005601169179 -0.71198595813373466434 1.7196429124913534814 -0.29394719550118636464 0.6119219806063816991 1.2013560678942543092 -0.31290707348115981423 0.33222046111233433097 0.8872438042110262213 0.090505754344117977928 0.10391134691764492004 0.91420450709314626803 -0.12840531226005513776 0.28298085181249482689 0.17295263733518087546 -0.40329885019790823186;-0.18196347420078559654 -0.17142584213854741848 1.0186972942701519873 -0.17829168462786701421 0.16581547961162712568 -1.0859847271941245328 1.9587891921332984957 0.20836373832941249007 0.45389172342419642492 0.27836290291643117634 2.9830233200342295419 0.13151931231646937781 2.09541452461566724 0.14236567625415269545 -0.57591730821768771786 -0.29766884953027600291 0.3902186244967987272 -1.1553405706464552338 -0.1640054258867789938 -0.20490636615198742909;0.99866706601770938168 0.35625794176150826775 -0.028377443550167431169 0.85614301011158000509 -1.2262413100778959407 0.95651629182478914437 -0.60959430343866227719 0.053906204257005235769 1.3128808932707167756 -0.68982053061153025819 -0.44476791326495662693 0.14237117984376354562 0.53565188593263379779 -0.84275255177756824843 -0.76248278720954409948 -0.26358119905928278914 1.2930890055928978555 0.53435930982440749126 0.181702203880947738 -0.23550613955309382397];

% Layer 3
b3 = [-0.51483253039566612141;0.72947505001455392737;-0.53387318197635702521;-0.58174595427596453856;0.55592784450699306298;0.82474811912200307606;-1.1522567424867893315;-0.41162903901014075148;0.91910683604451570705;-0.82605825508371844013;-0.55199821971619744687;-0.48801626634105921276;0.7705524843143879421;-0.0016451718425292433806;-0.62525424333845003311;-0.9722739553903340104;-0.072746094164502464463;0.087166066364447528092;0.65658561905459222885;1.0725912154047481106];
LW3_2 = [0.021317537533136272226 -0.71663489284941361834 -0.11138552793452535794 -0.50119055776054155515 0.023079671698667546947 -0.47884664228895351679 -0.91483480634633473905 -0.28270771758144053187 -0.9055313290296160833 1.0755093104411443949 0.48862430991977578998 0.80055152224388426152 -0.10068465860994821326 0.31444209296467151571 -0.51670697446309654666 0.80421718172456502227 0.47154726192925272565 0.44319076144142449669 1.129326499361688052 -0.91922377673525945685;-0.12997890282832963438 -0.63113504491852179257 -0.94894507113782433638 -0.40331576316263362258 0.22722682355934939458 -0.99708647089806567987 -0.61354263592128210902 0.011964281606983741268 -0.15621645872012968059 -0.53462050574792863156 -0.89178244243262094759 -0.62285488963800872408 1.1225222170751203432 0.73269524997720636428 0.95183285003918438605 -0.79745455075252014154 0.018275276452785312736 -0.73247863591810591366 -0.40515856668422117748 -0.5765545766399738925;-0.13219911774517778547 0.39799554963223332527 -0.78394881327123466797 -0.63037790004684790546 -1.0873943021811038889 0.85551116882472943992 0.36463626126656939475 0.34073505433267753384 -0.79178356249088344132 0.51039488494102069893 -0.64288807887860366375 0.81971628446908662013 -0.31116735226466835096 0.15640506608072393679 0.14837418782839109643 -0.8843109445029612159 0.72770236917593000836 0.10563704527947832823 -0.069259639585797228012 0.86217328421361760782;-0.35191464028380564644 -0.30670086435753851628 0.25793264931072029666 0.16549167271982478944 -0.20734474956660903233 0.10707299164906039501 -0.22789762180830280824 -0.16516739266841592992 0.45958161462141816633 0.23050601823595021078 0.44392829864953470276 -0.70592822599896420943 0.18451244375082889726 0.58893558397522227654 -0.55608798718752261436 0.42450475954981364834 -0.41442379436162479767 -0.5206127310326700286 1.2645880409554990376 -0.41212552005130265176;-0.01601108730797634952 0.44008289383556375984 0.83640140461789680426 0.83525652152083851298 0.31777307065938614761 0.59196703154724517049 -0.99710900872534147243 -0.75450363740939352386 -0.24596862844958977679 0.57995888433262410278 -0.31376737369179580339 0.14051102590395656011 -0.86542914113548641275 -0.27403556894530833876 0.23121456847122201506 -0.23405243310984685801 -0.268534327897784586 -0.079245566512621629096 1.0266481717770155058 -0.96313124077134093515;-0.29815173714492265722 0.1050660313278032193 -0.39906997022541179643 0.076289949244764454495 0.76372893568995203761 0.6052919631241633347 -0.13420945856396407359 -0.50605099436979139593 -0.42982630685776768154 0.12794949885983453175 0.17610102274998126748 0.40912920182229228772 0.30600636677097220462 -0.27090536536990528216 -0.6369262685098744381 0.58805626925742726652 -0.16890531954513537949 0.6513639658384299258 -0.067596917464591510516 0.022470354213019374384;0.82098911868350687993 -0.29372709681502939816 0.11882790032096240962 0.58206610285533155746 0.31716746805091361461 -0.5147842047410986499 0.43622715167348913301 0.9061755376839756293 0.070782893768805171808 0.631169671680089861 -0.51147348546921467261 0.83315016346993020502 0.045485416274312573393 0.87004285693558180981 -0.50665211559931466745 0.2678812126563288043 0.063478092030843355498 0.89428812967460191707 -0.30041821480534353084 0.701886099789950757;0.83181750374137441995 0.83699693178507073021 -0.10077940549030420248 -0.82880248100604458905 0.25811998489340154395 -0.6286877873111386128 0.376091807009350243 -0.084194450530237871511 0.3987854710633111921 -0.27044214740873928626 -0.59206991766643157771 0.55814646823569857848 -0.69909978142638007359 -0.58024821504731094457 0.78501667741907499298 -0.032129814465437368798 0.40572112084854500269 -0.20635796654003846218 0.072446553401587079901 -0.79551717040802505387;-0.75051016933361791583 0.40672342006902439948 -0.6292544214172174355 -0.24801522998281158583 0.7417257510462035297 0.26486979467797988619 0.24056872660922107299 -0.83787007561746518203 0.51658357881554772817 0.59800721399341150164 0.56189155422434933218 0.82846075073585478954 -0.077262220162362851839 0.16258700183978025411 -0.62228062924606464268 0.73799321364018310998 -0.39921774374493557147 0.75481775278988860745 -1.3239368542281626517 0.25540875066487278566;0.062176376044595207948 0.60871052978845929804 0.4518014490885043366 0.79283139265193591783 0.48425852116840090167 0.054091641882154484211 -0.71560595975610696851 0.5071404409186337503 0.9006578626286839695 0.86005923128332029126 0.43529975671602477716 0.54575869381301733707 -0.49254609252196801528 -0.54562819105948046072 0.046570667968800147363 -0.42783440166096270429 -0.41266477843598659003 0.3928817493948859596 0.0070967815219237957713 -1.0276779371373043759;-0.71413424469481490142 0.36519481122308294907 -0.38187147785175007408 -0.50855128223810741606 -0.76483760975650005864 -0.60953239155702221286 0.70393288868630676802 -0.10887197935388118197 0.33045483226450478309 -0.96619506167478774739 -0.036814820193016337124 0.0064019456100573267354 0.6027612577078999001 0.76718632649947160473 1.0431852049190264431 0.69959194185296380564 -0.79466078550235053068 -0.90147918047784780793 0.95534679207995243377 -0.22085250960320854108;0.85210363951092860102 0.46007421940549536599 -0.18003516595924551336 -0.20935426426476713702 0.45429165556006856352 -0.15075658581345985354 -0.4487417781102291392 0.6614175503202752715 0.75761190864277794255 -0.71740919869330987968 0.44266901549954301709 -0.90823597604063011079 -0.80841200247183830907 0.32168782597393946743 -0.56388696091768952812 -0.24233260834359257596 -0.95226832659172089279 -0.29025536451480166145 -0.10774527771180729407 -0.20399183346370480807;-0.6099345942179466018 0.92483488394269541821 -0.84328491843287523011 0.4513141024268377266 -0.089527911948382651874 -0.71773470486770352128 0.53435639533666923207 -0.93540470944469100711 -0.11969763901944040219 -0.96183637297058011129 0.55238879630749793126 0.10972057819817242208 -0.094191881744099995033 -0.1980794459374706773 0.059007871270909874328 0.47487688458620408438 -0.2036183191344044241 0.73579418676167307467 -0.44353944323222355139 0.65715031457370354229;0.56527218529624767562 -0.42120885922288298087 0.091431601530548828327 -0.9024340193463962212 -0.7919152467475406576 -0.24685692198082395676 0.38797161033551108567 -0.52760503683782244977 -0.36581427226603652203 -0.75171319342796660834 -0.27464440615933649603 -0.28965773424332208474 -0.6310912103642699611 0.61196613340352334909 0.8244891752233125537 0.64014244161987976511 0.93132887738871206196 0.75275361059422918331 0.70514757779063608201 0.40709309331625320727;-0.873962831594072731 -0.41656987866291533829 -0.72477232202595931465 0.21297005470998747745 -0.66167449257319932432 -0.27661835720500110858 -0.31161792793702919324 0.4778635913951650438 0.3753134488412214198 0.95046993187226391786 -0.12052952068736788593 0.58125694852285014758 0.043868599023357324196 -0.71947070231129084394 0.75481296697612010327 -0.95150692720061491592 -0.72119183988649870898 0.83619077415104459128 -0.14343341846398860451 0.68878475761555224555;0.73011528357826538382 -0.27613897621150057526 -0.95752993043890266556 -0.84857415231316180027 -0.24102669503129320328 -0.078389440706495561173 0.2800777403989653247 0.75003029887903227557 -0.31293172800928048538 -0.47554607926388586803 -0.61960800945470106971 0.69693320723544038842 -0.27140535707636620488 -0.93410600185376313487 -0.2991653272241755479 0.14179551506520976512 0.68795441507810195514 0.20451000563109014707 -0.05189044898199986211 -0.45933663970803628729;0.55938042893211159523 0.7741665272163809064 0.64595549275514529963 0.010430628281741951766 -0.036210461843875559051 -0.65738277748481899199 0.74804272263111160068 -0.02484299258524529791 -0.3597848585238569985 -0.8362688493739435236 -0.54126463469441321585 -0.23663516085015068313 -0.051459119051716468995 -0.081262621490966566173 -0.034566486727905021414 -0.74376482639604213354 0.12784616773409546164 0.32175513219554047195 0.31582354284968627844 0.56167970412172862904;0.10267049049314609654 0.041763438462917537586 -0.29941049864596064323 0.19042224129395796117 0.25872674204487827732 -0.35495883158224450504 -0.4027265505177819449 -0.75038647137936931308 -0.17035248570047850647 0.10637293193024524585 0.037495800746419061245 0.63671352596386965317 0.90002671870297301648 0.59492950988952930658 -0.24743818247800364318 -0.78586171989677078287 -0.58239595298443624927 -0.94915314228265079688 0.88731188830604434958 -0.28660192652760374532;0.15890051212899006239 0.037491563987517427525 -0.028836483290673769336 0.50528592748823208947 0.99661495972290337075 -0.75733268577213497252 1.1226389427900722584 -0.75391158464274898865 -0.12998447578805980007 -0.42785501258466679397 -0.23484059006252078206 0.53416683694156175122 0.70638937502696885762 -0.048358254104802947393 -0.74068947313767186102 0.52878825476018731511 -0.73126148221263342908 0.85675234323330740072 1.7830417276363499379 -0.89452985810181662174;-0.32748649076719943407 -0.61822478399148195205 0.55864527273876229962 -0.62417084242162013119 -0.4697002356254705302 0.19656896926680783588 -0.65006990823833266102 0.76258408479285311188 0.0076234100438414085371 -0.097673967354439311661 0.14124256387277667191 -0.82236405101783660587 -0.49193589697511697079 -0.93840278609046023917 0.32580083798266318285 0.93523516041219634243 -0.15521808151534866038 -0.83865531744466470521 1.4787982189582833392 -0.29116913692451712459];

% Layer 4
b4 = [-0.72401644883777838135;0.77631279234540873091;0.94734378775765304415];
LW4_3 = [0.38291630894418327014 -0.18316514015091900358 -0.6066741264851545079 -0.98498705388417095996 -0.18287887166324398591 0.19807022241114746741 -0.71474694062038501841 -0.0021498703680200908703 0.25571420512703740835 0.034427119356127619532 0.12193699794915492662 -0.14439100451231423605 -0.65402265796451164448 -0.47467645974127486985 0.084954927613619474203 0.26454319133979209422 0.63345544715149382231 -0.22613082603264100801 0.008668979606980084518 0.01720240252002631573;-0.39592338124070475258 0.099111569995693052371 0.80309121124550908455 -0.11556687350167280104 -0.67880049191218949645 -0.49091837709796221079 -0.61454713107766767433 0.0362462247141669483 -0.30415356192773268518 0.27833509643331100225 -1.0093411848793141239 0.37002175253086033724 0.48395522502166088419 0.29831584556087653581 0.53828962308863070874 -0.21693149972947081694 -0.43621118201773251277 0.65499481278896831693 0.49702853759758935936 0.077879770913276150091;0.73216846854770800679 -1.0824423832728413686 0.52753810781181842415 0.53240579979076019246 0.84134930882804837005 0.0043272549535232759585 -0.68020266706135223966 0.47268104195080734575 -0.8966664966305004647 0.20704391136380687066 0.20791148059210567967 -0.49196739022098479044 0.12040814691407213111 0.60639400136714871614 0.12811226924332588806 0.25332215557379711424 0.13054022298774023425 0.59947029060481704654 1.5350330177539124321 1.629723730138463722];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0480105776098154;0.0510005931307965;0.0550426276001276];
y1_step1.xoffset = [-19.5002001900734;-21.1486530069743;0.00298527326573305];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = logsig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = radbas_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
  a = 1 ./ (1 + exp(-n));
end

% Radial Basis Transfer Function
function a = radbas_apply(n,~)
  a = exp(-(n.*n));
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
